<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Baixar Jogo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.hugeicons.com/font/hgi-stroke-rounded.css" />
  <link rel="shortcut icon" href="assets/appIcon.png">
  <link rel="stylesheet" href="index.css">
</head>
<body>
  <div id="particles-js"></div>
  <div class="musicPlayer mt-2">
    <div style="gap: 7px" class="d-flex flex-row justify-content-center align-items-center">
      <div class="d-flex flex-column justify-content-start align-items-start">
        <span class="playing"><b class="text-primary">Tocando:</b></span>
        <span id="playingMusic" class="playing_music text-white">Carregando...</span>
      </div>
      <div class="d-flex flex-column justify-content-end align-items-end">
        <button id="toggleVolume" class="mute_btn"><i id="volume_on" class="hgi-stroke hgi-volume-high"></i><i id="volume_off" style="display: none" class="hgi-stroke hgi-volume-mute-02"></i></button>
      </div>
    </div>
  </div>
  <div class="bottomText mt-2">
    <div class="d-flex flex-column">
      <span class="copy"><b class="text-primary">© 2024 Horizonte Roleplay.</b> <span class="text-white">Todos os direitos reservados.</span>
    </span>
  </div>
</div>
<div class="d-flex h-100 justify-content-center align-items-center">
  <div class="container text-center">
    <img src="assets/logo_new.png" class="mb-5" width="300px">
    <br>
    <div id="downloadContainer">
      <button id="downloadButton" class="btn btn-header mt-4">Instalar jogo</button>
      <br>
      <br>
      <small style="font-size: 0.5em" class="mt-3 text-white monument">Ao clicar no botão acima, faremos a instalação dos arquivos necessários.<br><b class="text-warning">Cerca de 3gb livres necessários.</b></small>
    </div>
    <div id="progressContainer" style="display: none" class="mt-3">
      <div class="progress">
        <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div class="row monument pt-2 text-uppercase" style="font-size: 0.6em">
        <div class="col-6 d-flex justify-content-start">
          <span id="progressLabel" class="float-left text-white">Fazendo download</span>
        </div>
        <div class="col-6 d-flex justify-content-end">
          <p id="progressText" class="text-primary">0%</p>
        </div>
      </div>
    </div>
  </div>
</div>

<audio id="backgroundMusic">
  <source id="musicSource" type="audio/mpeg">
    Seu navegador não suporta a reprodução de áudio.
  </audio>


  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>

  <script>
      // Playlist de músicas
    const playlist = [
      { title: "Let's Go 4 - MC PH", src: "assets/letsgo4.mp3" },
      { title: "MuluBeats - MTG CHIHIRO", src: "assets/chihiro.mp3" },
      { title: "DJ Topo - MTG Quem não quer sou eu", src: "assets/quemnaoquer.mp3" },
      { title: "Hungria - Mais brabo que vovô", src: "assets/maisbrabo.mp3" },
      { title: "Hungria - Chevette do Jacó", src: "assets/chevette.mp3" }
    // Adicione mais músicas conforme necessário
      ];

    let currentMusicIndex = 0;
    const musicElement = document.getElementById('backgroundMusic');
    const playingMusicElement = document.getElementById('playingMusic');
    let muted = false;

// Função para tocar a música aleatoriamente
    function playRandomMusic() {
      currentMusicIndex = Math.floor(Math.random() * playlist.length);
      const selectedMusic = playlist[currentMusicIndex];
      document.getElementById('musicSource').src = selectedMusic.src;
      playingMusicElement.textContent = selectedMusic.title;

    musicElement.load(); // Recarrega o áudio
    musicElement.volume = 0; // Começa com volume 0
    musicElement.play().catch(err => {
      console.error("Falha ao iniciar a música:", err);
    });

    // Aumentar o volume gradualmente
    let volume = 0;
    const interval = setInterval(() => {
      if(!muted) {
        if (volume < 0.5) {
          volume += 0.01;
          musicElement.volume = volume;
        } else {
          clearInterval(interval);
        }
      } else {
        musicElement.volume = 0;
      }
    }, 100);
  }

// Evento quando a música termina, toca uma nova música aleatória
  musicElement.addEventListener('ended', playRandomMusic);

// Inicia a primeira música
  playRandomMusic(); 

  document.getElementById('downloadButton').addEventListener('click', () => {
    document.getElementById('downloadContainer').style.display = "none";
    document.getElementById('progressContainer').style.display = "block";

        // Inicia o download pelo Electron
    window.electron.send('start-download');
  });

  document.getElementById('toggleVolume').addEventListener('click', () => {
    if(muted) {
      document.getElementById('volume_off').style.display = "none";
      document.getElementById('volume_on').style.display = "block";
    } else {
      document.getElementById('volume_on').style.display = "none";
      document.getElementById('volume_off').style.display = "block";
    }
    document.getElementById('backgroundMusic').volume = (!muted ? 0.5 : 0);
    muted = !muted;
  });

  window.electron.on('download-progress', (percent, extracting) => {
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const progressLabel = document.getElementById('progressLabel');

    if (extracting) {
      progressLabel.textContent = "Extraindo arquivos";
    } else {
      progressLabel.textContent = "Fazendo download";
    }

    progressBar.style.width = percent + '%';
    progressBar.setAttribute('aria-valuenow', percent);
    progressText.textContent = percent + '%';
    if(percent >= 99) musicElement.stop();
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<script type="text/javascript">
  particlesJS('particles-js', {
    "particles": {
      "number": {
        "value": 160,
        "density": {
          "enable": true,
          "value_area": 800
        }
      },
      "color": {
        "value": "#bbc6ff"
      },
      "shape": {
        "type": "circle",
        "stroke": {
          "width": 0,
          "color": "#bbc6ff"
        },
        "polygon": {
          "nb_sides": 5
        },
        "image": {
          "src": "https://horizonte-rp.com/assets/img/hzcoin_alt.png",
          "width": 500,
          "height": 500
        }
      },
      "opacity": {
        "value": 0.7,
        "random": true,
        "anim": {
          "enable": true,
          "speed": 1,
          "opacity_min": 0,
          "sync": false
        }
      },
      "size": {
        "value": 2,
        "random": true,
        "anim": {
          "enable": false,
          "speed": 4,
          "size_min": 0.1,
          "sync": false
        }
      },
      "line_linked": {
        "enable": false,
        "distance": 150,
        "color": "#ffffff",
        "opacity": 0.4,
        "width": 1
      },
      "move": {
        "enable": true,
        "speed": 1,
        "direction": "none",
        "random": true,
        "straight": false,
        "out_mode": "out",
        "bounce": false,
        "attract": {
          "enable": false,
          "rotateX": 600,
          "rotateY": 600
        }
      }
    },
    "interactivity": {
      "detect_on": "canvas",
      "events": {
        "onhover": {
          "enable": true,
          "mode": "bubble"
        },
        "onclick": {
          "enable": true,
          "mode": "repulse"
        },
        "resize": true
      },
      "modes": {
        "grab": {
          "distance": 400,
          "line_linked": {
            "opacity": 1
          }
        },
        "bubble": {
          "distance": 250,
          "size": 0,
          "duration": 2,
          "opacity": 0,
          "speed": 3
        },
        "repulse": {
          "distance": 400,
          "duration": 0.4
        },
        "push": {
          "particles_nb": 4
        },
        "remove": {
          "particles_nb": 2
        }
      }
    },
    "retina_detect": true
  });
</script>
</body>
</html>
